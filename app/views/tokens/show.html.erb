<% content_for :path do %><%=link_to 'tokens/','/tokens'%><%=@token.id.to_s%><% end %>
<table>
  <tr><th>operator</th><td>
   <%=link_to @token.user.name, '/users/'+@token.user_id.to_s%></td></tr>
 <tr><th>vibes</th><td><%=@token.vibes%><s>N</s></td></tr>
 <tr><th>furbaby#</th><td><%=@token.furbaby_id or 'none'%></td></tr>
</table>
<br>
<% if @furbaby %>
<%=button_to 'ðŸ‘‹ Pet this furbaby', '/tokens/'+@token.id.to_s, method: :patch%>
<% if current_user.id==@token.user_id and !@furbaby.name %>
<%=button_to 'ðŸ“ Name this furbaby', '/furbabies/'+@furbaby.id.to_s+'/edit', method: :get%>
<% end %>
<% if current_user.id==@token.user_id and @furbaby.heat? and current_user.empty_token %>
<%=button_to "ðŸ¥š Egg!", '/tokens/'+current_user.empty_token.id.to_s+'?furbaby='+@furbaby.id.to_s, method: :patch%>
This queen can lay an egg on one of your onoccupied tokens.
<% end %>
<% if current_user.id==@token.user_id and @furbaby.stud? and current_user.egg? %>
<%=button_to "ðŸ£ Hatch!", '/tokens/'+current_user.egg.id.to_s+'?furbaby='+@furbaby.id.to_s, method: :patch%>
This stud can hatch an egg on your other token.
<% end %>
<h2>This token's furbaby:</h2>
<%= render @furbaby %>
<% end %>
<% if @egg %>
<h2>This is an egg.</h2>
<% end %>
<% if current_user and current_user.id==@token.user_id and !@token.furbaby_id %>
 <h2>Adopt a Furbaby!</h2>
 <p>You can use this unoccupied token to adopt a stray a furbaby and save it
   from a terrible fate.</p>
 <h3>Look for a furbaby trading under this symbol:</h3>
<p>
 <span class="btn">
   <%
{sun:'ðŸŒž', moon:'ðŸŒ›', terra: 'ðŸŒ'}.entries.each do |k,v|
   %>
 <%= link_to v+k.to_s, controller: 'furbabies', action: 'new',
    token_id: @token.id, symbol: k %>
  <% end %>
 </span>
 </p>
<% end %>

<script type="module">
<% if @furbaby %>
renderer.flyTo="cat";
<% elsif @egg %>
renderer.flyTo="egg";
<% else %>
  renderer.flyTo="coin";
<% end %>
<% if params[:pet]=="true" %>
 renderer.flyTo="hand";
<%end %>
</script>
